# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: "[PROD] Deploy to IONOS server"
'on':
  push:
    branches:
      - main
jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    steps:
      - name: "[PROD] Deploy to IONOS server"
        uses: appleboy/ssh-action@master
        with:
          host: ${{secrets.SSH_HOST}}
          username: ${{secrets.SSH_USERNAME}}
          password: ${{secrets.SSH_PASSWORD}}
          script: |
            export NVM_DIR=~/.nvm
            source ~/.nvm/nvm.sh
            cd ./terappy/frontend/therappy-app/
            git pull origin main
            nvm use 16
            npm i && CI=false
            npm run build
            cd
            rsync -a ./terappy/frontend/therappy-app/build /var/www/terappy.mx/html
            echo 'Deployment to IONOS server finished'